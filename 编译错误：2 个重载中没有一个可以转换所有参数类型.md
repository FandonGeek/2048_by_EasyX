编译错误：2 个重载中没有一个可以转换所有参数类型
=========================

## 错误描述：

一些程序在 VC6 下运行好好地，但是放到 VC2008 及更高版本 VC 下编译却报错误（以下仅以 VC2008 举例，高版本 VC 类似），例如使用如下语句：

    outtextxy(10, 20, "Hello World");

在 VC6 下可以成功编译，但在 VC2008 下编译后会有错误。

错误提示如下：

    error C2665: “outtextxy”: 2 个重载中没有一个可以转换所有参数类型

同样的，对于其他一些包含字符串调用的函数，例如 loadimage、drawtext 等，也会遇到类似问题。

## 错误原因：

简单来说，这是由于字符编码问题引起的。

VC6 默认使用的 MBCS 编码，而 VC2008 及高版本 VC 默认使用的 Unicode 编码。以下详细解释这个问题：

用 char 表示字符时，英文占用一个字节，中文占用两个字节。这样有一个严重的问题：两个连续字节，究竟是两个英文字符，还是一个中文字符？为了解决这个问题，Unicode 编码诞生了。Unicode 编码不管中文英文都用两个字节表示。

对于 MBCS 编码，字符变量用 char 定义。  对于 Unicode 编码中，字符变量用 wchar\_t 定义。

为了提高代码的自适应性，微软在 tchar.h 里面定义了 TCHAR，而 TCHAR 会根据项目定义的编码，自动展开为 char 或 wchar\_t。

在 Windows API 和 EasyX 里面的大多数字符串指针都用的 LPCTSTR 或 LPTSTR 类型，LPCTSTR / LPTSTR 就是“Long Point (Const) Tchar STRing”的缩写。所以可以认为，LPCTSTR 就是 const TCHAR \*，LPTSTR 就是 TCHAR \* 。

于是，在 VS2008 里面，给函数传递 char 字符串时，就会提示前述错误。

## 解决方案：

解决方法有多个，目的一样，都是让字符编码相匹配。

**方法一：**将所有字符串都修改为 TCHAR 版本。

简单来说需要注意以下几点：

1\. 在程序中使用 #include 添加对 TCHAR 的支持。

2\. 对于字符串，例如 "abc" 用 \_T("abc") 表示。就是加上 \_T("")。

3\. 定义字符变量时，将 char 换成 TCHAR。

4\. 操作字符串的函数也要换成相应的 TCHAR 版本，例如 strcpy 要换成 \_tcscpy。（详见 MSDN）

**方法二：**在代码中取消 Unicode 编码的宏定义，让后续编译都以 MBCS 编码进行。

方法很简单，只需要在代码文件的顶部增加以下代码：

    #undef UNICODE
    #undef _UNICODE

这样就可以取消 Unicode 编码的宏定义，让整个项目以 MBCS 编码编译。

**方法三：**在 VC2008 里面，将项目属性中的字符编码修改为 MBCS。

操作步骤：点菜单“项目-> xxx 属性...”，点左侧的“配置属性”，在右侧的设置中找到“字符集”，修改默认的“使用 Unicode 字符集”为“使用多字节字符集”。

设置完毕后，再次编译就可以看到问题已经解决。